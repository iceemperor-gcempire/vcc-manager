# v1 업데이트 내역

## v1.4.10

- fix: 미사용 세션 인증 인프라 제거, JWT 전용 인증으로 전환 — F-04 (#108)
  - `express-session`, `connect-mongo` 의존성 제거
  - 세션 미들웨어, `passport.session()`, serialize/deserialize 제거
  - JWT/API Key 없는 요청에 세션 폴백 대신 401 반환으로 CSRF 공격 표면 제거
  - `SESSION_SECRET` 환경변수 및 관련 설정/문서 제거
- fix: OAuth 콜백에서 JWT를 URL fragment로 전환 — F-05 (#109)
  - 리다이렉트를 `?token=` → `#token=`으로 변경하여 서버 로그/Referer 노출 차단
  - 프론트엔드에서 `window.location.hash` 기반 토큰 파싱 + `history.replaceState()` URL 정리
- fix: 약한 기본 secret/fallback 값 제거 — F-06 (#120)
  - `signedUrl.js`에서 `'default-secret'` 폴백 제거, 미설정 시 즉시 throw
  - `docker-compose.prod.yml`에서 비밀번호 폴백을 `:?` 구문으로 교체하여 미설정 시 기동 실패
- fix: validate 미들웨어에서 민감 입력 로그 제거 — F-07 (#110)
  - `req.body` 전체 출력 `console.log` 제거 (password 평문 노출 차단)
- fix: 사용자 입력 정규식 이스케이프로 ReDoS 방지 — F-08 (#111)
  - `escapeRegex()` 유틸 함수로 7개 라우트 + 1개 모델, 총 24곳에 적용
- test: F-06 시크릿 fail-fast 및 프로덕션 compose 검증 테스트 추가
- test: F-08 escapeRegex 단위 테스트 추가
- docs: MIT 라이선스 문서 추가
- chore: .claude 폴더를 .gitignore에 추가

## v1.4.9

- fix: signed URL 서브디렉토리 allowlist에 `/videos/` 경로 추가
  - v1.4.8의 F-01 보안 수정 시 allowlist에 누락되어 동영상 프리뷰가 403으로 차단되던 문제 수정

## v1.4.8

- fix: signed URL 경로 검증 및 파일 접근 통제 강화 — F-01 (#105)
  - IDOR 취약점이 있는 미사용 `GET /api/files/sign` 엔드포인트 제거
  - null byte 차단, `..` 경로 조작 차단, `path.normalize()` 적용
  - 서브디렉토리 allowlist (`/generated/`, `/reference/`) 적용
- fix: 복구 API filePath 신뢰 제거 — 서버 측 경로 관리로 전환 — F-02 (#106)
  - RestoreJob 모델에 `tempFilePath` 필드 추가, 클라이언트 경로 전달 제거
  - `path.resolve()` + `startsWith()` 기반 경로 검증으로 backup-temp 디렉토리만 허용
- fix: 외부 HTML sanitize 적용으로 XSS 취약점 제거 — F-03 (#107)
  - DOMPurify 기반 `sanitizeHtml` 유틸리티로 Civitai description HTML sanitize
  - 서식 태그만 허용, script/iframe/img/이벤트 핸들러 등 제거
- fix: 운영 환경 필수 시크릿 미설정 시 즉시 종료(fail-fast) — F-06
- test: F-01 signed URL 경로 검증 테스트 추가
- test: F-02 복구 API 경로 검증 테스트 추가
- test: F-03 sanitizeHtml XSS 방어 테스트 추가 (33개 케이스)

## v1.4.7

- feat: MCP `upload_image` 도구 신규 추가 (#103)
  - base64 이미지를 VCC 서버에 업로드하여 imageId 반환
  - 반환된 imageId를 `generate`/`continue_job`의 이미지 타입 필드에 사용 가능
- feat: MCP `generate`/`continue_job`에서 이미지 타입 커스텀 필드 지원 (#103)
  - `additionalParams`에 imageId 문자열 전달 시 `{ imageId }` 형식으로 자동 변환
- feat: MCP `apiClient`에 `formData` 전송 지원 추가 (#103)

## v1.4.6

- fix: MCP `download_result`에서 `VCC_BASE_URL_FOR_MCP` 설정 시 signed URL 반환 실패 수정 (#100)
  - 백엔드 응답 미들웨어가 이미 서명한 URL을 재서명 시도하여 실패하던 문제 해결
- refactor: `MCP_BASE_URL` → `VCC_BASE_URL_FOR_MCP` 환경 변수 이름 변경 (#100)
  - MCP 서버 주소로 오인될 수 있는 이름을 VCC 서버 기본 URL 의미에 맞게 변경
- feat: `download_result` 응답에 `responseType` 필드 추가 (#100)
  - `signedUrl` / `base64` / `metadata` / `file` 값으로 클라이언트가 응답 형식 판별 가능
- docs: MCP 스킬 문서 전면 보강 — 전체 도구 명세 포함

## v1.4.5

- fix: ComfyUI WebSocket 바이너리 메시지(이미지 프리뷰 등) 파싱 오류 수정
- fix: MCP API 클라이언트 JSON 파싱 실패 시 원인 로그 출력 개선

## v1.4.4

- style: 대시보드 레이아웃 개선
  - 서버 작업 상태 / 내 작업 상태를 하나의 카드로 통합하여 하단 배치
  - 빠른 액션 버튼 세로 배치로 변경

## v1.4.3

- feat: Signed URL 라운딩 간격을 환경변수(`SIGNED_URL_ROUND_SECONDS`)로 분리 (#95)
  - 기본값 1440초(24분)로 설정하여 만료 시간(1시간)과 경계 충돌 방지
- fix: AI 프롬프트 생성 다이얼로그 모바일 레이아웃 개선 (#96)
  - 작업판 이름이 길 때 타이틀이 세로로 깨지는 문제 수정
  - 작업판 이름과 "변경" 버튼을 분리된 테두리 영역으로 재구성

## v1.4.2

- feat: MCP HTTP 모드에서 `MCP_BASE_URL` 설정 시 signed URL 우선 반환
  - 이미지/비디오 모두 signed URL로 반환하여 mcp-remote 1MB 제한 우회
  - 미설정 시 기존 동작 유지 (이미지 base64, 비디오 메타데이터 + 설정 안내)
- refactor: `VCC_PUBLIC_URL` → `MCP_BASE_URL` 환경 변수 이름 변경
  - MCP 서버만 사용하는 값이므로 `MCP_` 접두어로 통일
  - `.env.example`에 누락되어 있던 항목 추가
- docs: MCP Server 도구 호출 명세 문서 추가 (`docs/MCP_SERVER_API.md`)

## v1.4.1

- fix: ComfyUI 캐시/빠른 완료 시 WebSocket 완료 메시지 감지 누락 수정 (#88)
  - WebSocket 연결 순서를 ComfyUI 공식 패턴에 맞게 변경 (connect → prompt)
  - 캐시 히트나 빠른 모델에서도 완료 메시지를 정상 수신
- fix: 동영상 썸네일 화면 깜박임 수정 (#91)
  - Signed URL 만료 타임스탬프를 5분 단위로 라운딩하여 동일 구간 내 동일 URL 보장
  - 비디오 요소의 key를 안정적인 ID 기반으로 변경하여 불필요한 재마운트 방지

## v1.4.0

- feat: Signed URL 기반 미디어 파일 접근 제어 (#85)
  - HMAC-SHA256 서명 + 만료시간 기반 Signed URL 도입
  - `/uploads/*` 직접 접근 차단, `/api/files/*` 라우트에서 서명 검증 후 파일 서빙
  - API 응답 시 모든 `/uploads/...` URL을 자동으로 signed URL로 변환
  - DB에는 기존 `/uploads/...` 형식 유지 (프론트엔드 변경 없음)
  - MCP HTTP 모드에서 `MCP_BASE_URL` 설정 시 signed URL 반환 지원
- docs: 환경 변수 변경 시 연관 파일 체크리스트 추가

## v1.3.7

- fix: MCP API Key 인증 일원화 — MCP_API_KEY와 VCC_API_KEY를 통합하여 클라이언트 Bearer 토큰 패스스루 방식으로 변경 (#79)
- feat: MCP HTTP 모드 멀티유저 지원 — 각 클라이언트가 자신의 VCC API Key로 독립 인증
- refactor: MCP apiClient를 팩토리 패턴으로 리팩토링 (세션별 API 클라이언트 생성)
- docs: MCP Server 인증 구조 문서 전면 개편

## v1.3.6

- feat: API Key 생성 및 관리 기능 추가 - 프로필 > 보안 설정에서 키 생성/파기, 최대 10개 (#79)
- feat: X-API-Key 헤더 기반 API 인증 지원 - 로그인 없이 외부 프로그램에서 API 접근 가능 (#79)
- feat: MCP 서버 인증을 이메일/비밀번호에서 API Key 방식으로 전환 (#79)
- style: 프로필 페이지 레이아웃을 수직 배치로 변경
- docs: Issue 처리 절차에 이슈 닫기 단계 추가

## v1.3.5

- feat: 작업 히스토리에서 다른 작업판으로 작업 이어가기 - 스마트 필드 매칭으로 파라미터 자동 매칭 (#76)
- feat: MCP Server continue_job 도구 추가 - 같은/다른 작업판에서 작업 이어가기 지원 (#76)
- feat: 다른 작업판으로 이어가기 시 마지막 생성 이미지를 이미지 타입 필드에 자동 주입 (#76)
- docs: MCP Server 문서 통합 (docs/MCP_SERVER.md) 및 Claude Code 등록 가이드 추가

## v1.3.4

- fix: iOS Safari 다운로드 워크어라운드 제거, 모든 플랫폼에서 표준 다운로드 방식으로 통일 (#69)

## v1.3.3

- feat: 작업판 백업/복원(내보내기/가져오기) 기능 추가 (#52)
- feat: MCP Server stdio → Streamable HTTP 전환 및 Docker 컨테이너 분리
- fix: MCP HTTP 모드 세션 관리 race condition 해결 (`onsessioninitialized` 콜백)
- docs: MCP 클라이언트별 연결 가이드 및 mcp-remote 제한사항 문서화

## v1.3.2

- feat: 이미지 목록 다중삭제 기능 추가 - 선택 항목 일괄 삭제 및 검색 결과 전체 삭제 (#17)
- fix: 프롬프트 데이터 목록에서 시드 칩 표시 제거

## v1.3.1

- fix: 프로덕션 docker-compose 누락 환경변수 추가 및 배포 스크립트 정리

## v1.3.0

- feat: 프로젝트 커버 이미지 기능 추가 (#63)
- refactor: ProjectEditDialog를 공통 컴포넌트로 추출 (#63)
- fix: ImageSelectDialog useEffect 의존성 버그 수정 (이미지 선택 불가 문제)
- fix: 프로젝트 커버 이미지 imageType 정규화 처리
- feat: 프로젝트 기능 추가 - 프로젝트 목록, 상세, 즐겨찾기, 전용 태그 (#51)
- fix: 프로젝트 기능 누락 항목 보완 (#51)
- fix: 작업 계속하기 시 태그가 새 작업에 이어지도록 수정 (#51)
- refactor: 공통 컴포넌트 추출 및 프로젝트 상세 기능 보강 (#63)

## v1.2.6

- feat: 태그 검색과 태그 관리 메뉴를 하나의 페이지로 통합 (#62)
- feat: 작업판 편집 시 선택 항목 드래그앤드롭 순서 변경 기능 추가 (#61)
- feat: 작업판 관리 화면에 출력 타입, AI API 타입 필터 추가 (#57)
- feat: 작업 히스토리 카드 레이아웃 데스크탑 개선 (#59)
- fix: LoRA 목록에서 비디오 미디어 썸네일 최적화 - hover 시에만 재생
- fix: LoRA 목록 페이지 애니메이션 과다로 인한 성능 개선
- docs: Issue 처리 절차에 comment 보강 지침 추가

## v1.2.5

- feat: 작업판 검색 필터 보존 기능 추가 (#55)
- feat: 설정 페이지에 작업판 필터 초기화 옵션 추가 (#55)
- feat: 프롬프트 데이터 UI 개선 - 정방형 섬네일, 이미지 뷰어, 태그 기반 필터링, 메모 우선 표시 (#54)
- feat: 대시보드 업데이트 로그 뷰어 추가 (#56)
- feat: AI 에이전트 통합을 위한 MCP 서버 추가
- chore: 서버별 관리로 전환된 환경변수(COMFY_UI_BASE_URL, CIVITAI_API_KEY) 예시 파일에서 제거 (#53)

## v1.2.4

- feat: 프롬프트 데이터 로드 시 대표 이미지 자동 첨부 (#49)
- fix: 프롬프트 저장 시 마지막 결과 이미지를 대표 이미지로 사용
- feat: 작업판 타입 구조 개편 및 미디어 순서 보존 (#48)
- feat: 비밀번호 재설정 기능 추가 (#47)
- fix: LoRA 페이지네이션 UX 개선
- feat: 일반 사용자용 LoRA 기능 추가 (#45)
- fix: LoRA 모바일 레이아웃 및 반응형 개선
- fix: 중복 API 호출로 인한 메모리 이슈 방지
- feat: LoRA 강제 새로고침 옵션 추가
- fix: LoRA Civitai 데이터 NSFW 필드 누락 수정
- feat: LoRA 관리 UI 개선
- feat: NSFW 필터 및 Civitai API 키 설정 추가
- feat: LoRA 관리 페이지 및 해시 조회 최적화
- feat: 서버 관리 페이지에 LoRA 동기화 버튼 추가
- feat: Civitai 연동 LoRA 메타데이터 조회 기능
- fix: 태그 usageCount 콘텐츠 생성/삭제 시 동기화
- feat: 비동기 백업 실행 및 백업 중 시스템 잠금 (#44)
- feat: 서버 백업 및 복원 기능 추가 (#44)
- refactor: "추가 입력값"을 "커스텀 필드"로 명칭 변경
- feat: 워크플로우 변수 참조 표시 기능
- fix: GeneratedImage/GeneratedVideo 모델 jobId 선택적으로 변경
- feat: 사용자 설정 페이지 추가 (삭제/계속 동작 옵션)
- feat: 작업판 삭제와 비활성화 분리
- feat: 관리자 비활성 작업판 관리 기능
- feat: 이미지 업로드 미리보기 개선
- feat: 워크플로우 템플릿에 해시된 user_id 변수 추가
- fix: 서버 업데이트 시 기존 API 키 보존
- fix: 관리자 대시보드에서 최근 작업 뷰 제거 (프라이버시)
- fix: 작업 히스토리 삭제 시 연관 비디오도 삭제 (#29)
- refactor: 비디오 뷰어를 공통 VideoViewerDialog 컴포넌트로 통합 (#28)
- refactor: 이미지 선택을 ImageSelectDialog 컴포넌트로 통합
- fix: nginx client_max_body_size 50M으로 증가
- fix: ComfyUI prompt_id 필터링 및 이미지 필드 개선
- feat: 비디오 생성 지원 추가
- feat: 이미지/프롬프트 데이터에 태그 편집 UI 추가 (#18)
- feat: 태그 시스템을 사용자 기반 개인 기능으로 변경 (#18)
- feat: 작업판, 이미지, 프롬프트 데이터용 태그 시스템 추가 (#18)
- fix: 프롬프트 작업판 UI에서 시스템 프롬프트 숨김 (#25)
- feat: 이미지 작업판에 AI 프롬프트 생성 기능 추가 (#24)
- fix: 로그인/로그아웃 시 쿼리 캐시 초기화 (#22)
- fix: 작업판 복제 시 serverId/workboardType 누락 수정 (#20, #21)
- feat: 프롬프트 작업판 지원 (텍스트 생성) (#14)
- refactor: ImageViewerDialog를 공유 컴포넌트로 추출
- feat: 프롬프트 데이터 관리 시스템 구현 (#11)
- fix: 이미지 생성에서 참조 이미지 섹션 제거 (#12)
- refactor: WorkboardBasicInfoForm 공유 컴포넌트로 추출
- refactor: AdminPanel을 사이드바 개별 메뉴로 분리
- feat: 추가 입력 필드에 이미지 타입 지원 (#12)
- feat: 종합 서버 관리 시스템 구현

## v1.0.4

- feat: 재사용 가능한 Pagination 컴포넌트 생성
- fix: 내 이미지 페이지 가로 스크롤 방지를 위한 스마트 페이지네이션

## v1.0.3

- feat: 일반 사용자용 대시보드 재설계 및 모바일 네비게이션 개선
- feat: 작업 히스토리 삭제 시 연관 이미지 자동 삭제
- fix: 프로덕션 중지 스크립트에서 docker compose down 사용
- fix: iPhone Safari 이미지 다운로드 문제 해결
- feat: 작업 히스토리 페이지 모바일 최적화 (페이지네이션 개선)
- feat: 종합 사용자 승인 시스템 구현
- feat: LoRA 모델 목록 기능 구현
- feat: 프로덕션 중지 스크립트 추가 및 중복 시스템 통계 메뉴 제거

## v1.0.2

- update: 작업판 기본 해상도 설정 변경 및 레이아웃 개선

## v1.0.1

- fix: '계속하기' 작업 버그 해결
- fix: 워크플로우 프롬프트 이중 이스케이프 방지

## v1.0.0

- feat: VCC Manager 초기 릴리스
- feat: ComfyUI 워크플로우 기반 이미지 생성 관리 시스템
- feat: 사용자 인증 및 권한 관리
- feat: 작업판 관리 (생성/수정/삭제)
- feat: 이미지 생성 및 업로드 기능
- feat: 작업 히스토리 관리
- feat: 관리자 대시보드
